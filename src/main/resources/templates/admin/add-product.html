<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Add Products</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
<script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('hidden');
        }
    </script>
<script>
    if (performance.navigation.type === 2) {
        // user clicked back button
        window.location.href = "/admin/products";
    }
</script>
</head>

<body class="bg-gray-100">
	<!-- Top Navbar (mobile only) -->


<div class="bg-blue-900 text-white p-4 flex items-center justify-between md:hidden">
    <a href="/admin/dashboard" class="text-xl font-bold">
        Admin Panel
    </a>
    <button onclick="toggleSidebar()" class="text-white focus:outline-none text-2xl">
        ☰
    </button>
</div>

	<div class="flex flex-col md:flex-row min-h-screen">
		<!-- Sidebar -->
		<aside id="sidebar"	class="bg-blue-900 text-white w-full md:w-64 md:block hidden">
			<div class="p-6 text-center text-xl font-bold border-b border-blue-700">Admin Panel</div>
				<nav class="flex flex-col p-4 space-y-2">
					<a href="/admin/dashboard" class="hover:bg-blue-700 p-2 rounded">Dashboard</a>
					<a href="/admin/users" class="hover:bg-blue-700 p-2 rounded">Manage Users</a>
					<a href="/admin/products" class="bg-blue-700 p-2 rounded">Manage Products</a> 
					<a href="/admin/orders"	class="hover:bg-blue-700 p-2 rounded">Manage Orders</a>
					<a href="/admin/payments" class="hover:bg-blue-700 p-2 rounded">Manage Payments</a>
					<a href="/admin/settings" class="hover:bg-blue-700 p-2 rounded">Settings</a>
				</nav>
			<div class="p-4 border-t border-blue-700">
				<a href="/admin/logout" class="block text-red-400 hover:text-white">Logout</a>
			</div>
		</aside>

		<!-- Main Content -->
		<main class="flex-1 p-4 md:p-7">
			<div class="max-w-7xl mx-auto">
				<div class="mb-6 flex flex-col md:flex-row md:items-center md:justify-between">
					<!-- Heading + Subheading -->
					<div>
						<h1 class="text-2xl md:text-3xl font-semibold text-gray-800" th:text="${isEdit} ? 'Edit Product' : 'Add New Product'">Add New Products</h1>
						
					</div>

					<!-- Add Product Button -->
					<a href="/admin/products" class="mt-4 md:mt-0 bg-blue-600 hover:bg-blue-700 text-white text-sm px-5 py-2 rounded shadow-md transition duration-200">
						← Back to Products
					</a>
				</div>

				<form th:action="@{/admin/products/add}" th:object="${product}" method="post" enctype="multipart/form-data" class="space-y-6">


    <input type="hidden" th:field="*{id}" /> <!-- important for edit -->

    <!-- Product Name -->
    <div>
        <label class="block text-gray-600">Product Name</label>
        <input type="text" th:field="*{name}" class="w-full px-4 py-2 border rounded" required/>
    </div>

    <!-- Description -->
    <div>
        <label class="block text-gray-600">Description</label>
        <textarea th:field="*{description}" maxlength="255" rows="4" class="w-full px-4 py-2 border rounded" required></textarea>
    </div>

    <!-- Price & Stock -->
    <div class="grid grid-cols-2 gap-4">
        <div>
            <label class="block text-gray-600">Price</label>
            <input type="number" th:field="*{price}" step="0.01" class="w-full px-4 py-2 border rounded" required/>
        </div>
        <div>
            <label class="block text-gray-600">Stock</label>
            <input type="number" th:field="*{stock}" class="w-full px-4 py-2 border rounded" required/>
        </div>
    </div>

    <!-- Active -->
    <div>
        <label class="block text-gray-600">Active</label>
        <input type="checkbox" th:field="*{active}" class="mr-2 leading-tight"/>
        <span class="text-gray-700">Is Active?</span>
    </div>

    <!-- Image -->
    <div>
        <label class="block text-gray-600">Product Image</label>
        <input type="file" name="productImage"  accept="image/*" class="w-full px-4 py-2 border rounded"/>
    </div>

    <!-- Submit -->
    <div class="flex justify-end">
        <button type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-2 rounded shadow">
            <span th:text="${isEdit} ? 'Update Product' : 'Add Product'">Add Product</span>
        </button>
    </div>
</form>

			</div>
		</main>
	</div>
	<script>
    function updateCharCount(textarea) {
        document.getElementById('charCount').innerText = textarea.value.length;
    }

    // initialize if editing existing text
    document.addEventListener("DOMContentLoaded", function() {
        const textarea = document.querySelector("textarea[th\\:field='*{description}']");
        if (textarea) {
            updateCharCount(textarea);
        }
    });
</script>
	
</body>
</html>
