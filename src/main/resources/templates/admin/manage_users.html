<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Manage Users</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link
	href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
	rel="stylesheet" />
<script>
        function searchTable() {
            const input = document.getElementById("searchInput").value.toLowerCase();
            const rows = document.querySelectorAll("#userTable tbody tr");
            rows.forEach(row => {
                const name = row.cells[1].textContent.toLowerCase();
                const email = row.cells[2].textContent.toLowerCase();
                row.style.display = (name.includes(input) || email.includes(input)) ? "" : "none";
            });
        }

        function toggleStatus(btn) {
            btn.classList.toggle('bg-green-500');
            btn.classList.toggle('bg-red-500');
            btn.textContent = btn.textContent === "Active" ? "Inactive" : "Active";
        }
    </script>

</head>
<body class="bg-gray-100">

	<!-- Mobile Top Navbar -->
	<div
		class="bg-blue-900 text-white p-4 flex items-center justify-between md:hidden">
		<div class="text-xl font-bold">Admin Panel</div>
		<button
			onclick="document.getElementById('sidebar').classList.toggle('hidden')">â˜°</button>
	</div>

	<!-- Sidebar + Main -->
	<div class="flex flex-col md:flex-row min-h-screen">

		<!-- Sidebar -->
		<aside id="sidebar"
			class="bg-blue-900 text-white w-full md:w-64 md:block hidden">
			<div
				class="p-6 text-center text-xl font-bold border-b border-blue-700">Admin
				Panel</div>
			<nav class="flex flex-col p-4 space-y-2">
				<a href="/admin/dashboard" class="hover:bg-blue-700 p-2 rounded">Dashboard</a>
				<a href="/admin/users" class="bg-blue-700 p-2 rounded">Manage
					Users</a> <a href="/admin/products"
					class="hover:bg-blue-700 p-2 rounded">Manage Products</a> <a
					href="/admin/orders" class="hover:bg-blue-700 p-2 rounded">Manage
					Orders</a> <a href="/admin/payments"
					class="hover:bg-blue-700 p-2 rounded">Manage Payments</a> <a
					href="/admin/settings" class="hover:bg-blue-700 p-2 rounded">Settings</a>
			</nav>
			<div class="p-4 border-t border-blue-700">
				<a href="/logout" class="block text-red-400 hover:text-white">Logout</a>
			</div>
		</aside>

		<!-- Main Content -->
		<main class="flex-1 p-4 md:p-7">
			<div class="mb-6">
				<h1 class="text-3xl font-semibold text-gray-800">Manage Users</h1>
				<p class="text-gray-500">List of registered users</p>
			</div>

			<!-- Search Bar -->
			<div
				class="flex flex-col md:flex-row items-center justify-between mb-4 space-y-2 md:space-y-0">
				<input id="searchInput" onkeyup="searchTable()" type="text"
					placeholder="Search by name or email"
					class="w-full md:w-1/3 px-4 py-2 border border-gray-300 rounded shadow-sm focus:outline-none" />
			</div>

			<!-- User Table -->
			<div class="overflow-x-auto bg-white rounded shadow mt-4"
				id="userTable">
				<table class="min-w-full divide-y divide-gray-200">
					<thead class="bg-blue-50">
						<tr>
							<th
								class="px-6 py-3 text-left text-xs font-semibold text-blue-700 uppercase">#</th>
							<th
								class="px-6 py-3 text-left text-xs font-semibold text-blue-700 uppercase">Name</th>
							<th
								class="px-6 py-3 text-left text-xs font-semibold text-blue-700 uppercase">Email</th>
							<th
								class="px-6 py-3 text-left text-xs font-semibold text-blue-700 uppercase">Status</th>
							<th
								class="px-6 py-3 text-left text-xs font-semibold text-blue-700 uppercase">Actions</th>
						</tr>
					</thead>
					<tbody class="bg-white divide-y divide-gray-100"
						th:each="user, iterStat : ${users}">
						<tr class="hover:bg-gray-50">
							<td class="px-6 py-4 text-sm text-gray-700"
								th:text="${iterStat.index + 1}">1</td>
							<td class="px-6 py-4 font-medium text-gray-900"
								th:text="${user.name}">John Doe</td>
							<td class="px-6 py-4 text-sm text-gray-700"
								th:text="${user.email}">john@example.com</td>
							<td class="px-6 py-4">
								<button onclick="toggleStatus(this)"
									class="text-white text-xs px-4 py-1 rounded bg-green-500">Active</button>
							</td>
							<td class="px-6 py-4 space-x-2">
								<button	class="bg-yellow-400 hover:bg-yellow-500 text-white text-xs px-3 py-1 rounded">Edit</button>
								<!-- Delete Button --> <a href="javascript:void(0);"
								onclick="openDeleteModal(this)"
								th:attr="data-user-id=${user.id}" title="Delete"
								class="bg-red-500 hover:bg-red-600 text-white text-xs px-3 py-1 rounded">
									Delete </a>

							</td>
						</tr>
					</tbody>
				</table>
			</div>

		</main>
	</div>
	<!-- Delete Confirmation Modal -->
	<div id="deleteModal"
		class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
		<div class="bg-white p-6 rounded-lg shadow-md w-full max-w-md">
			<h2 class="text-lg font-semibold text-gray-800 mb-4">Confirm
				Deletion</h2>
			<p class="text-gray-600 mb-6">Are you sure you want to delete
				this user?</p>
			<div class="flex justify-end space-x-3">
				<button onclick="closeDeleteModal()"
					class="px-4 py-2 text-gray-600 hover:text-white hover:bg-gray-500 rounded">
					Cancel</button>
				<a id="confirmDeleteBtn"
					class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
					Delete </a>
			</div>
		</div>
	</div>


</body>
<script>
function openDeleteModal(element) {
    const userId = element.getAttribute("data-user-id");
    const confirmBtn = document.getElementById('confirmDeleteBtn');
    confirmBtn.href = `/admin/users/delete/${userId}`;
    document.getElementById('deleteModal').classList.remove('hidden');
}

function closeDeleteModal() {
    document.getElementById('deleteModal').classList.add('hidden');
}

</script>


</html>
